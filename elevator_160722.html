<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>엘레베이터 용자들이여 힘을내요!!</title>
    <style>
        * {margin:0; padding:0;}
        body {height:100%;}
        div {text-align:center; box-sizing: border-box}
        ul {background:#ff6600; height:100%;}
        li {list-style: none; padding:19.3px 0;}
    </style>
    <script src="./jquery/jquery3.1.0.js"></script>
    <script src="js/elevator/frame.js"></script>
</head>
<body>
    <script>
        // 사용자코드
        var $body = $(document.body);                   
        var elevator = new Button(150, 300, 'relative', 'solid 1px #ccc', 'Elevator');                  
        
        elevator.render($body);                            
        
        
        // jquuery code
        // 습관이란 무섭다.
        // 전역에 객체들이 넘쳐나고 있음 추후에 이걸 어떻게 정리할거지 ?
        

        var oneFloor = Number($('div').outerHeight());
        var idx = 0;
        var speed = 1000;
        var arriveStage;
        var a;
        var time;
        var nowStage = Number($('div').position().top)/oneFloor;
        var deviceHeight = ($(window).height());
        var liNum = $( "ul > li" ).length;
        
        // body height 엘레베이터 층수에 따라 달라짐 추후 frame으로 뺼필요 있음.
        $('body').css('height', liNum * oneFloor);       
        $('ul').on('click', 'li', function(e){
            e.stopPropagation();
            idx = Number($(this).index());
            nowStage = Number($('div').position().top)/oneFloor;
            arriveStage = oneFloor*idx;
            a =  Math.abs(idx-nowStage);
            time = Math.ceil(speed*a);
            move();
            return false; 
        
        });
        
        
        /*
        sample 예제.
        이전 코드 : 97번째줄로 코드를 조금씩 확장시켜나가는게 이프로젝트의 목적입니다.
        그리고 당장은 완성형 코드는 아니지만 조금씩 개선 방향도 생각나는되로 적으면 될것 같습니다.
        깃허브를 통해서 민호님에게 add를 추가해서 커밋을 날리면 최종 커밋을 민호님 판단하에 최종 커밋을 하시면 될거 같네요.
        function move(){
            $('div').stop().animate({'top' : arriveStage}, speed * a); 
        }
        */
        
        // 엘레베이터 이동
        function move(){
            // if의 조건으로 일단 특정 동작후 동작으로 해놓음 이조건도 정수일때라는 걸로 풀어쓸수 있음 더 좋을듯
            // ex if(nowStage === 정수){동작}
            // 만약 nowStage로 값을 비교해서 특정 조건일때는 그층으로 이동하게 함수를 실행 할수도 있을듯.
            // ex) 5층을 누르고 이동중에 2층에서 3층을 눌렀을때 nowStage 값이 < idx 값도다 작으면 3층으로 갈수 있게
            if(nowStage === 0 || nowStage === 1  || nowStage === 2 || nowStage === 3 || nowStage === 4){
                $('div').stop().animate({'top' : arriveStage, scrollTop : oneFloor * (nowStage-1)}, time);
                return scrollMove();
            }
            
        }
        
        // scroll 이동
        function scrollMove(){
            // 스크롤 이동 시간 계산이 어려움 수학 필요. 이동한 만큼의 높이값으로 내려가야함.
            /*
            move 함수에서 처리할것이냐 따로 계산해서 뽑을 것이냐.
            각 device의 위치값을 넘어설때부터 스크롤의 top 값이 지속적으로 변동이 되어야함 엘레베이터 이동 속도와 동일한 속도로.
            */
            /*
            if(){
                $('html,body').animate({ scrollTop : stagePosition }, time);  //<--- 이걸 지속적으로 할수 있으면 됨.
            } 
            */
            // 이렇게 구현하는건 어려우니까 스크롤도 엘레베이터랑 같이 이동한다.
            // 즉 1,2,3,4,5 일경우 0, 300, 600, 900, 1200
            // 이것의 자연스러움을 주려면 또 분기를 나눠야 할듯.
            // ex) 1-5층 갈때 1-2갈때 등 분기를 나누든가 공식이 필요함.
            // scroll 이동에 대해선 연구가 필요함 어떤 이동 방식이 좋을지 고민해봐야 할듯.
            // 그냥 겐또로 /2 했는데 우연히 자연스럽게 움직임 -_-;
            console.log(idx);
            console.log(idx * 300);
            $('html,body').animate({ scrollTop : (300 * idx)/2 }, time);
            return false;
            
        }

        
    </script>    
</body>
</html>